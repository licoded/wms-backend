<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="Bookmark" href="/favicon.ico" >
    <link rel="Shortcut Icon" href="/favicon.ico" />
    <!-- [if lt IE 9]>
    src="static/lib/html5shiv.js"></script>
    <script type="text/javascript" src="static/lib/respond.min.js"></script>
    <![endif] -->

    <link rel="stylesheet" type="text/css" href="static/js/uiadmin/h-ui/css/H-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="static/js/uiadmin/h-ui.admin/css/H-ui.admin.css" />
    <link rel="stylesheet" type="text/css" href="static/js/uiadmin/lib/Hui-iconfont/1.0.8/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="static/js/uiadmin/h-ui.admin/skin/default/skin.css" id="skin" />
    <link rel="stylesheet" type="text/css" href="static/js/uiadmin/h-ui.admin/css/style.css" />
    <!--提示框-->
    <link rel="stylesheet" type="text/css" href="static/js/uiadmin/pop_up/dialog/dialog.css" />
    <script type="text/javascript" src="static/js/uiadmin/pop_up/dialog/zepto.min.js"></script>
    <script type="text/javascript" src="static/js/uiadmin/pop_up/dialog/dialog.min.js"></script>
    <!--[if IE 6]>
    <script type="text/javascript" src="static/js/uiadmin/lib/DD_belatedPNG_0.0.8a-min.js" ></script>
    <script>DD_belatedPNG.fix('*');</script>
    <![endif]-->
    <title>仓储信息管理系统V1.0</title>
</head>
<body>
<header class="navbar-wrapper">
    <div class="navbar navbar-fixed-top">
        <div class="container-fluid cl"> <a class="logo navbar-logo f-l mr-10 hidden-xs" href="/index">
            仓储信息管理系统</a> <a class="logo navbar-logo-m f-l mr-10 visible-xs" href="/index">H-ui</a>
            <span class="logo navbar-slogan f-l mr-10 hidden-xs">V1.0</span>
            <a aria-hidden="false" class="nav-toggle Hui-iconfont visible-xs" href="javascript:;">&#xe667;</a>

            <nav id="Hui-userbar" class="nav navbar-nav navbar-userbar hidden-xs">
                <ul class="cl">
                    <li><span id="user_name"></span></li>
                    <li class="dropDown dropDown_hover">
                        <a href="#" class="dropDown_A">
<!--                            <span id="user_repository"></span>-->
                            <i class="Hui-iconfont">&#xe6d5;</i></a>
                        <ul class="dropDown-menu menu radius box-shadow">
                            <li><a href="javascript:;" onClick="myselfinfo()">个人信息</a></li>
                            <li><a href="/">切换账户</a></li>
                            <li><a href="/">退出</a></li>
                        </ul>
                    </li>

                    <li id="Hui-msg">
                        <a  title="库存预警">
                            <i   id="kcyj" class="Hui-iconfont" style="font-size:18px;">&#xe672;</i></a>
                    </li>

                    <li id="Hui-skin" class="dropDown right dropDown_hover"> <a href="javascript:;" class="dropDown_A" title="换肤"><i class="Hui-iconfont" style="font-size:18px">&#xe62a;</i></a>
                        <ul class="dropDown-menu menu radius box-shadow">
                            <li><a href="javascript:;" data-val="default" title="默认（黑色）">默认（黑色）</a></li>
                            <li><a href="javascript:;" data-val="blue" title="蓝色">蓝色</a></li>
                            <li><a href="javascript:;" data-val="green" title="绿色">绿色</a></li>
                            <li><a href="javascript:;" data-val="red" title="红色">红色</a></li>
                            <li><a href="javascript:;" data-val="yellow" title="黄色">黄色</a></li>
                            <li><a href="javascript:;" data-val="orange" title="橙色">橙色</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</header>
<aside class="Hui-aside">
    <div class="menu_dropdown bk_2">

        <dl>
            <dt><i class="Hui-iconfont">&#xe616;</i> 用户管理<i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i></dt>
            <dd>
                <ul id="yhgl">
                    <li><a data-href="change-password.html" data-title="修改信息" href="javascript:void(0)">修改信息</a></li>
                </ul>
            </dd>
        </dl>
        <dl>
            <dt><i class="Hui-iconfont">&#xe616;</i> 仓库管理<i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i></dt>
            <dd>
                <ul id="ckgl">

                </ul>
            </dd>
        </dl>
        <dl>
            <dt><i class="Hui-iconfont">&#xe616;</i> 调拨管理<i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i></dt>
            <dd>
                <ul id="dbgl">

                </ul>
            </dd>
        </dl>
        <dl>
            <dt><i class="Hui-iconfont">&#xe616;</i> 业务情况<i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i></dt>
            <dd>
                <ul id="ywqk">
                    <li><a data-href="money-list.html" data-title="业务结转" href="javascript:void(0)">业务结转</a></li>
                </ul>
            </dd>
        </dl>

    </div>
</aside>
<div class="dislpayArrow hidden-xs"><a class="pngfix" href="javascript:void(0);" onClick="displaynavbar(this)"></a></div>
<section class="Hui-article-box">
    <div id="Hui-tabNav" class="Hui-tabNav hidden-xs">
        <div class="Hui-tabNav-wp">
            <ul id="min_title_list" class="acrossTab cl">
                <li class="active">
                    <span title="时间线" data-href="article-tbsssc.html">时间线</span>
                    <em></em></li>
            </ul>
        </div>
        <div class="Hui-tabNav-more btn-group"><a id="js-tabNav-prev" class="btn radius btn-default size-S" href="javascript:;"><i class="Hui-iconfont">&#xe6d4;</i></a><a id="js-tabNav-next" class="btn radius btn-default size-S" href="javascript:;"><i class="Hui-iconfont">&#xe6d7;</i></a></div>
    </div>
    <div id="iframe_box" class="Hui-article">
        <div class="show_iframe">
            <div style="display:none" class="loading"></div>
            <iframe scrolling="yes" frameborder="0" src="note.html"></iframe>
        </div>
    </div>
</section>

<div class="contextMenu" id="Huiadminmenu">
    <ul>
        <li id="closethis">关闭当前 </li>
        <li id="closeall">关闭全部 </li>
    </ul>
</div>
<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="static/js/uiadmin/lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="static/js/uiadmin/lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="static/js/uiadmin/h-ui/js/H-ui.min.js"></script>
<script type="text/javascript" src="static/js/uiadmin/h-ui.admin/js/H-ui.admin.js"></script> <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="static/js/uiadmin/lib/jquery.contextmenu/jquery.contextmenu.r2.js"></script>
<script type="text/javascript">

    var repository;
    $(function () {
        $.ajax({
            url: "/user/getSysUser",
            type: "GET",
            dataType : 'json',
            data: {},
            error:function (data) {},
            success:function (data) {
                if(data.state == 1){
                    // $("#user-name").text(data.sysUser.name);
                    // $("#user-mail").text(data.sysUser.mail);
                    $("#user_name").text(data.sysUser.user_name);
                    repository =data.sysUser.user_repository;
                    // $("#user_repository").text(data.sysUser.user_repository);
                    if(data.sysUser.user_chmod == 0){//admin
                        // document.getElementById("Hui-msg_son").style.color="green";
                        $("#ckgl").append("<li><a data-href=\"repository-list.html\" data-title=\"仓库维护\" " +
                            "href=\"javascript:void(0)\">仓库维护</a></li>");
                        $("#ckgl").append("<li><a data-href=\"material-list.html\" data-title=\"进货\" " +
                            "href=\"javascript:void(0)\">进货</a></li>");
                        // $("#ckgl").append("<li><a data-href=\"out-warehouse.html\" data-title=\"出库管理\"" +
                        //     " href=\"javascript:void(0)\">退货</a></li>");
                        $("#ckgl").append("<li><a data-href=\"pandian.html\" data-title=\"盘点管理\" " +
                            "href=\"javascript:void(0)\">盘点</a></li>");
                        // $("#ckgl").append("<li><a data-href=\"pandian.html\" data-title=\"盘点管理\" " +
                        //     "href=\"javascript:void(0)\">领回料</a></li>");
                        $("#ckgl").append("<li><a data-href=\"shop-return-list.html\" data-title=\"销售与退货\"" +
                            " href=\"javascript:void(0)\">销售与退货</a></li>\n");


                        $("#dbgl").append("<li><a data-href=\"cache-list.html\" data-title=\"调拨物资\"" +
                            " href=\"javascript:void(0)\">调拨物资</a></li>\n");
                        $("#dbgl").append("<li><a data-href=\"dispatch-list.html\" data-title=\"调拨记录\" " +
                            "href=\"javascript:void(0)\">调拨记录</a></li>\n");

                        $("#yhgl").append("<li><a data-href=\"admin-list.html\" data-title=\"员工管理\" " +
                            "href=\"javascript:void(0)\">员工管理</a></li>");

                        $("#ywqk").append("<li><a data-href=\"in-out.html\" data-title=\"业务汇总\" " +
                            "href=\"javascript:void(0)\">业务汇总</a></li>");


                    }
                    if(data.sysUser.user_chmod == 1){//调拨员
                        $("#dbgl").append("<li><a data-href=\"cache-list.html\" data-title=\"调拨物资\"" +
                            " href=\"javascript:void(0)\">调拨物资</a></li>\n");
                        $("#dbgl").append("<li><a data-href=\"dispatch-list.html\" data-title=\"调拨记录\" " +
                            "href=\"javascript:void(0)\">调拨记录</a></li>\n");
                    }
                    if(data.sysUser.user_chmod == 2){//仓库管理员
                        $("#ckgl").append("<li><a data-href=\"material-list.html\" data-title=\"进货\" " +
                            "href=\"javascript:void(0)\">进货</a></li>");
                        $("#ckgl").append("<li><a data-href=\"pandian.html\" data-title=\"盘点管理\" " +
                            "href=\"javascript:void(0)\">盘点</a></li>");
                        $("#ckgl").append("<li><a data-href=\"shop-return-list.html\" data-title=\"销售与退货\"" +
                            " href=\"javascript:void(0)\">销售与退货</a></li>\n");


                        $("#dbgl").append("<li><a data-href=\"dispatch-list.html\" data-title=\"调拨记录\" " +
                            "href=\"javascript:void(0)\">调拨记录</a></li>\n");
                        $("#ywqk").append("<li><a data-href=\"in-out.html\" data-title=\"业务汇总\" " +
                            "href=\"javascript:void(0)\">业务汇总</a></li>");

                        //显示库存预警


                    }

                    $(function () {
                        $.ajax({
                            type: "POST",
                            url: "/error/isFull",
                            data:{
                                "repository_id":repository
                            },
                            success:function (data) {
                                if(data==1){
                                    document.getElementById("kcyj").style.color="green";
                                }else if(data==2){
                                    document.getElementById("kcyj").style.color="yellow";
                                }else{
                                    document.getElementById("kcyj").style.color="red";
                                }
                            }
                        });
                    });

                }else {
                    location.assign("/");
                }
            }
        });
    });


    function Queue(size) {
        var list = [];

        //向队列中添加数据
        this.push = function(data) {
            if (data==null) {
                return false;
            }
            //如果传递了size参数就设置了队列的大小
            if (size != null && !isNaN(size)) {
                if (list.length == size) {
                    this.pop();
                }
            }
            list.unshift(data);
            return true;
        }

        //从队列中取出数据
        this.pop = function() {
            return list.pop();
        }

        //返回队列的大小
        this.size = function() {
            return list.length;
        }

        //返回队列的内容
        this.quere = function() {
            return list;
        }
    }

    /*个人信息*/
    function myselfinfo(){

        $.ajax({
            url: "/user/getSysUser",
            type: "GET",
            dataType : 'json',
            data: {},
            cache: false,
            error:function (data) {},
            success:function (data) {
                if(data.state == 1){
                    var content = "<div><table><tbody>" +
                        "<tr><td>用户名</td><td>"+data.sysUser.user_name+"</td></tr>" ;
                        // +"<tr><td>账号</td><td>"+data.sysUser.mail+"</td></tr>" +
                        // "<tr><td>电话</td><td>"+data.sysUser.user_repository+"</td></tr>";
                    if(data.sysUser.user_chmod==0){
                        content += "<tr><td>权限</td><td>root</td></tr>" ;
                        content +="<tr><td>仓库</td><td>掌控全局</td></tr>";
                        // content += "<tr><td>仓库</td><td>管理"+data.sysUser.user_repository+"的诸多事宜</td></tr>";
                    }
                    if(data.sysUser.user_chmod==1){
                        content += "<tr><td>权限</td><td>调拨员</td></tr>" ;
                        content += "<tr><td>仓库</td><td>可以调拨很多仓库</td></tr>";
                    }
                    if(data.sysUser.user_chmod==2){
                        content += "<tr><td>权限</td><td>仓库管理员</td></tr>" ;
                        content += "<tr><td>仓库</td><td>管理"+data.sysUser.user_repository+"号仓库的诸多事宜</td></tr>";
                    }
                    content += "<tr><td>账户余额</td><td>"+data.sysUser.user_money+"</td></tr>";
                    content += "</tbody></table></div>";
                    layer.open({
                        type: 1,
                        area: ['300px','200px'],
                        fix: false, //不固定
                        maxmin: true,
                        shade:0.4,
                        title: '查看信息',
                        content: content

                    });
                }
            }
        });

    }

   //  // 测试预警功能
    //库存预警
    function  isFull() {
        $.ajax({
            type: "POST",
            url: "/error/isFull",
            data:{
                "repository_id":$("#repository").val()
            },
            success:function (data) {
                if(data==1){
                    document.getElementById("kcyj").style.color="green";
                }else if(data==2){
                    document.getElementById("kcyj").style.color="yellow";
                }else{
                    document.getElementById("kcyj").style.color="red";
                }
            }
        });
    }

</script>

</body>
</html>